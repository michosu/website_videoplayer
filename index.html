<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Video Player</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Bungee:wght@400&family=Nunito:wght@700;900&display=swap');

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: #1a1a2e;
    display: flex; align-items: center; justify-content: center;
    min-height: 100vh;
    font-family: 'Nunito', sans-serif;
  }

  .player-wrapper {
    position: relative;
    width: 720px; max-width: 95vw;
  }

  .video-frame {
    position: relative;
    border-radius: 18px; overflow: hidden;
    background: #000; aspect-ratio: 16 / 9;
    border: 4px solid rgba(255,255,255,0.25);
    box-shadow: 0 0 30px rgba(0,150,255,0.15);
  }

  .video-frame iframe {
    width: 100%; height: 100%; border: none; display: block;
  }

  /* Poster shown before play is clicked */
  .poster {
    position: absolute; top: 0; left: 0; right: 0; bottom: 0;
    z-index: 3; cursor: pointer;
    background: #000;
  }
  .poster img {
    width: 100%; height: 100%; object-fit: cover; display: block;
  }
  .poster-btn {
    position: absolute; top: 50%; left: 50%;
    transform: translate(-50%, -50%);
    width: 68px; height: 68px;
    background: rgba(255,0,0,0.88);
    border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    transition: transform 0.15s ease, background 0.15s ease;
  }
  .poster:hover .poster-btn {
    background: #ff0000;
    transform: translate(-50%, -50%) scale(1.08);
  }
  .poster-btn svg { fill: white; width: 28px; height: 28px; margin-left: 4px; }

  /* Click overlay for play/pause after player starts */
  .click-overlay {
    position: absolute; top: 0; left: 0; right: 0; bottom: 0;
    z-index: 2; cursor: pointer; display: none;
  }

  /* Controls */
  .controls-bar {
    margin-top: -2px;
    background: linear-gradient(180deg, #3BAAFF 0%, #0088E0 100%);
    border-radius: 0 0 16px 16px;
    padding: 10px 16px;
    border: 3px solid #FFD000; border-top: none;
    box-shadow: 0 4px 20px rgba(0,0,0,0.3);
    display: flex; align-items: center; gap: 8px;
  }

  .btn {
    background: linear-gradient(180deg, #4DC4FF 0%, #0077CC 100%);
    border: 2px solid rgba(255,255,255,0.3);
    border-radius: 10px; color: white; cursor: pointer;
    display: flex; align-items: center; justify-content: center;
    transition: all 0.1s ease;
    box-shadow: 0 3px 6px rgba(0,0,0,0.25), inset 0 1px 2px rgba(255,255,255,0.3);
    flex-shrink: 0;
  }
  .btn:hover  { background: linear-gradient(180deg, #6FD4FF 0%, #0099EE 100%); transform: translateY(-1px); }
  .btn:active { transform: translateY(1px) scale(0.96); }
  .btn-sm   { width: 32px; height: 32px; font-size: 14px; }
  .btn-play { width: 50px; height: 50px; font-size: 22px; border-radius: 14px; }
  .icon { fill: white; width: 1em; height: 1em; display: block; }

  .volume-slider {
    -webkit-appearance: none; appearance: none;
    width: 70px; height: 6px;
    background: rgba(0,0,0,0.3); border-radius: 3px;
    outline: none; cursor: pointer; flex-shrink: 0;
  }
  .volume-slider::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 14px; height: 14px; background: white;
    border-radius: 50%; cursor: pointer; box-shadow: 0 1px 4px rgba(0,0,0,0.3);
  }
  .spacer { flex: 1; }

  /* Timeline */
  .timeline-bar {
    position: relative;
    background: linear-gradient(180deg, #FFD000 0%, #FFAA00 100%);
    border-radius: 0 0 12px 12px;
    padding: 8px 14px 14px;
    border: 3px solid #FFD000; border-top: none; margin-top: -2px;
    display: flex; align-items: center; gap: 10px;
  }
  .time-label {
    font-family: 'Bungee', cursive; font-size: 13px;
    color: #1a1a2e; min-width: 38px; user-select: none;
  }
  .time-label.right { text-align: right; }
  .timeline-track {
    flex: 1; height: 10px;
    background: rgba(0,0,0,0.2); border-radius: 5px;
    position: relative; cursor: pointer; overflow: visible;
  }
  .timeline-buffer {
    position: absolute; top: 0; left: 0; height: 100%;
    background: rgba(255,255,255,0.2); border-radius: 5px; pointer-events: none;
  }
  .timeline-progress {
    position: absolute; top: 0; left: 0; height: 100%;
    background: linear-gradient(90deg, #4AE54A, #00CC00);
    border-radius: 5px; pointer-events: none; transition: width 0.1s linear;
  }
  .timeline-handle {
    position: absolute; top: 50%;
    width: 16px; height: 16px; background: #4AE54A;
    border: 2px solid white; border-radius: 50%;
    transform: translate(-50%,-50%); pointer-events: none;
    box-shadow: 0 1px 4px rgba(0,0,0,0.3); transition: left 0.1s linear;
  }

  .drips {
    position: absolute; bottom: -18px; left: 10%; right: 10%;
    display: flex; justify-content: space-around; pointer-events: none;
  }
  .drip {
    width: 12px; height: 18px; background: #FFAA00;
    border-radius: 0 0 50% 50%; animation: dripDrop 3s ease-in-out infinite;
  }
  .drip:nth-child(2){animation-delay:.7s;height:14px}
  .drip:nth-child(3){animation-delay:1.4s;height:22px}
  .drip:nth-child(4){animation-delay:.3s;height:16px}
  .drip:nth-child(5){animation-delay:2.1s;height:12px}
  @keyframes dripDrop {
    0%,100%{transform:scaleY(1)}
    50%{transform:scaleY(1.3);opacity:.8}
  }
</style>
</head>
<body>

<div class="player-wrapper">

  <div class="video-frame">
    <iframe
      id="yt-iframe"
      allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
      allowfullscreen
    ></iframe>

    <!-- Shown before play — clicking this triggers the first play -->
    <div class="poster" id="poster">
      <img id="posterImg" src="" alt="Video thumbnail">
      <div class="poster-btn">
        <svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
      </div>
    </div>

    <!-- Shown after the player starts, intercepts click-to-pause -->
    <div class="click-overlay" id="clickOverlay"></div>
  </div>

  <div class="controls-bar">
    <button class="btn btn-sm" id="muteBtn" title="Mute/Unmute">
      <svg class="icon" viewBox="0 0 24 24"><path id="volumeIcon" d="M3 9v6h4l5 5V4L7 9H3z"/></svg>
    </button>
    <input type="range" class="volume-slider" id="volumeSlider" min="0" max="100" value="80">
    <div class="spacer"></div>
    <button class="btn btn-play" id="playBtn" title="Play/Pause">
      <svg class="icon" viewBox="0 0 24 24"><path id="playIcon" d="M8 5v14l11-7z"/></svg>
    </button>
    <div class="spacer"></div>
    <div style="width:110px"></div>
  </div>

  <div class="timeline-bar">
    <span class="time-label"      id="currentTime">0:00</span>
    <div class="timeline-track" id="timelineTrack">
      <div class="timeline-buffer"   id="timelineBuffer"></div>
      <div class="timeline-progress" id="timelineProgress"></div>
      <div class="timeline-handle"   id="timelineHandle"></div>
    </div>
    <span class="time-label right" id="totalTime">0:00</span>
    <div class="drips">
      <div class="drip"></div><div class="drip"></div><div class="drip"></div>
      <div class="drip"></div><div class="drip"></div>
    </div>
  </div>

</div>

<script>
// ── CONFIG ────────────────────────────────────────────────────────────────────
const VIDEO_ID = 'dQw4w9WgXcQ';

// ── POSTER ────────────────────────────────────────────────────────────────────
// Show the YouTube thumbnail while the player hasn't loaded yet
document.getElementById('posterImg').src =
  'https://img.youtube.com/vi/' + VIDEO_ID + '/hqdefault.jpg';

// ── YOUTUBE IFRAME API ────────────────────────────────────────────────────────
const tag = document.createElement('script');
tag.src = 'https://www.youtube.com/iframe_api';
document.head.appendChild(tag);

let player = null, isReady = false, isSeeking = false, lastVolume = 80;
let ytApiReady = false;

window.onYouTubeIframeAPIReady = function () { ytApiReady = true; };

function startPlayer() {
  // Setting iframe.src INSIDE a click handler = user-initiated navigation.
  // The browser allows autoplay with sound for user-initiated navigations,
  // the same way a classic YouTube embed plays when you click its thumbnail.
  const ytIframe = document.getElementById('yt-iframe');
  ytIframe.src = 'https://www.youtube.com/embed/' + VIDEO_ID
    + '?autoplay=1&enablejsapi=1&controls=0&rel=0&modestbranding=1'
    + '&playsinline=1&iv_load_policy=3'
    + '&origin=' + encodeURIComponent(window.location.origin);

  // Attach YT API to the iframe (no videoId — src is already set above)
  player = new YT.Player(ytIframe, {
    events: {
      onReady: onPlayerReady,
      onStateChange: onPlayerStateChange,
    },
  });

  // Hide poster, show click overlay
  document.getElementById('poster').style.display = 'none';
  document.getElementById('clickOverlay').style.display = 'block';
}

function onPlayerReady() {
  isReady = true;
  player.setVolume(80);
  document.getElementById('totalTime').textContent = formatTime(player.getDuration());
  setInterval(updateTimeline, 250);
}

function onPlayerStateChange(e) {
  document.getElementById('playIcon').setAttribute('d',
    e.data === 1
      ? 'M6 19h4V5H6v14zm8-14v14h4V5h-4z'  // pause icon
      : 'M8 5v14l11-7z'                      // play icon
  );
  if (e.data === 0) { player.seekTo(0); player.pauseVideo(); } // ended
}

// ── DOM REFS ──────────────────────────────────────────────────────────────────
const playBtn          = document.getElementById('playBtn');
const muteBtn          = document.getElementById('muteBtn');
const volumeSlider     = document.getElementById('volumeSlider');
const timelineTrack    = document.getElementById('timelineTrack');
const timelineProgress = document.getElementById('timelineProgress');
const timelineHandle   = document.getElementById('timelineHandle');
const timelineBuffer   = document.getElementById('timelineBuffer');
const currentTimeEl    = document.getElementById('currentTime');
const totalTimeEl      = document.getElementById('totalTime');

// ── PLAY / PAUSE ──────────────────────────────────────────────────────────────
function togglePlay() {
  if (!isReady) return;
  player.getPlayerState() === 1 ? player.pauseVideo() : player.playVideo();
}

function handleFirstPlay() {
  if (!ytApiReady) return; // API still loading — user can click again in <1s
  startPlayer();
}

document.getElementById('poster').addEventListener('click', handleFirstPlay);
document.getElementById('clickOverlay').addEventListener('click', togglePlay);

playBtn.addEventListener('click', () => {
  if (!player) { handleFirstPlay(); } else { togglePlay(); }
});

// ── VOLUME / MUTE ─────────────────────────────────────────────────────────────
volumeSlider.addEventListener('input', (e) => {
  if (!isReady) return;
  const vol = +e.target.value;
  player.setVolume(vol);
  if (vol > 0) { player.unMute(); lastVolume = vol; }
  setVolumeIcon(vol);
});

muteBtn.addEventListener('click', () => {
  if (!isReady) return;
  if (player.isMuted() || player.getVolume() === 0) {
    player.unMute(); player.setVolume(lastVolume);
    volumeSlider.value = lastVolume; setVolumeIcon(lastVolume);
  } else {
    lastVolume = player.getVolume();
    player.mute(); volumeSlider.value = 0; setVolumeIcon(0);
  }
});

function setVolumeIcon(vol) {
  const p = document.getElementById('volumeIcon');
  if (vol === 0)
    p.setAttribute('d','M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z');
  else if (vol < 50)
    p.setAttribute('d','M18.5 12c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM5 9v6h4l5 5V4L9 9H5z');
  else
    p.setAttribute('d','M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z');
}

// ── TIMELINE ──────────────────────────────────────────────────────────────────
function updateTimeline() {
  if (!isReady || isSeeking) return;
  const cur = player.getCurrentTime(), dur = player.getDuration();
  if (!dur) return;
  const pct = (cur / dur) * 100;
  timelineProgress.style.width = pct + '%';
  timelineHandle.style.left   = pct + '%';
  currentTimeEl.textContent   = formatTime(cur);
  timelineBuffer.style.width  = (player.getVideoLoadedFraction() * 100) + '%';
}

function seekFromEvent(e) {
  if (!isReady) return;
  const rect = timelineTrack.getBoundingClientRect();
  const pct  = Math.max(0, Math.min(e.clientX - rect.left, rect.width)) / rect.width;
  const t    = pct * player.getDuration();
  timelineProgress.style.width = (pct * 100) + '%';
  timelineHandle.style.left   = (pct * 100) + '%';
  currentTimeEl.textContent   = formatTime(t);
  player.seekTo(t, true);
}

timelineTrack.addEventListener('mousedown', (e) => {
  isSeeking = true; seekFromEvent(e);
  const mv = (e) => seekFromEvent(e);
  const up = () => { isSeeking = false; document.removeEventListener('mousemove', mv); document.removeEventListener('mouseup', up); };
  document.addEventListener('mousemove', mv);
  document.addEventListener('mouseup', up);
});
timelineTrack.addEventListener('touchstart', (e) => { isSeeking = true; seekFromEvent(e.touches[0]); });
timelineTrack.addEventListener('touchmove',  (e) => { e.preventDefault(); seekFromEvent(e.touches[0]); });
timelineTrack.addEventListener('touchend',   ()  => { isSeeking = false; });

function formatTime(s) {
  return Math.floor(s / 60) + ':' + String(Math.floor(s % 60)).padStart(2, '0');
}
</script>

</body>
</html>
